<!DOCTYPE html>
<html>
<head>
  <title>Scandit to SharePoint</title>
  <script src="https://cdn.jsdelivr.net/npm/scandit-sdk@6.x/build/scandit-sdk.min.js"></script>
  <style>
    #scanner { width: 100%; height: 300px; }
    #status { font-weight: bold; margin-top: 1em; }
  </style>
</head>
<body>
  <h2>Scan and Send to SharePoint</h2>
  <div id="scanner"></div>
  <p id="status">Waiting for duck...</p>

  <script>
    const POWER_AUTOMATE_URL = "https://prod-25.canadacentral.logic.azure.com:443/workflows/ab1985337bb94d1798ceacdef4a727be/triggers/manual/paths/invoke?api-version=2016-06-01"; // ← Replace this
    const PROJECT_KEY = "d3f1c202a95f76b4b94d24b1af4a2e0838d24808ccd8debfa23cd924e80020d4"; // ← Replace this

    ScanditSDK.configure(PROJECT_KEY, {
      engineLocation: "https://cdn.jsdelivr.net/npm/scandit-sdk@6.x/build/",
    }).then(() => {
      return ScanditSDK.BarcodePicker.create(document.getElementById("scanner"), {
        playSoundOnScan: true,
        vibrateOnScan: true
      });
    }).then(barcodePicker => {
      barcodePicker.onScan(scanResult => {
        const barcode = scanResult.barcodes[0].data;
        document.getElementById("status").textContent = "Scanned: " + barcode;

        fetch(POWER_AUTOMATE_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            barcode: barcode,
            scannedBy: "Device1",
            scanTime: new Date().toISOString()
          })
        }).then(res => {
          document.getElementById("status").textContent = res.ok ? "Sent to SharePoint!" : "Failed to send.";
        });
      });
    });
  </script>
</body>
</html>
